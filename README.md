# Детективная Ролевая Игра с ИИ-Ведущим

## Описание игры

Это интерактивная детективная ролевая игра, где ИИ выступает в роли ведущего (мастера игры). Игроки берут на себя роли персонажей в рамках заданного сценария, один из которых является убийцей. Цель невиновных - раскрыть преступление, в то время как убийца пытается скрыть свою вину.

Игра сочетает элементы классической "Мафии" с глубоким нарративом, генерацией уникальных сценариев и персонажей с помощью ИИ.

## Workflow игры

### 1. Создание/присоединение к игре
- Игрок может создать новую игру (генерируется уникальный код) или присоединиться к существующей по коду
- Создатель игры указывает количество игроков (от 1 до 8) и сценарий (короткое описание ситуации)

### 2. Ожидание игроков
- Игроки присоединяются к комнате по коду
- Отображается текущий статус (сколько игроков уже в комнате)

### 3. Выбор персонажей
- Когда все игроки присоединились, ИИ генерирует уникальных персонажей с ролями и описаниями
- Каждый игрок выбирает себе персонажа
- Случайным образом выбирается убийца (это знает только ИИ и сам убийца)

### 4. Получение воспоминаний
- Каждый игрок получает уникальную информацию о событиях:
  - Невиновные получают частичные воспоминания и подсказки
  - Убийца получает полную информацию о преступлении и свою ложную легенду

### 5. Фаза расследования
- Игроки описывают свои действия по расследованию (что хотят сделать/узнать)
- ИИ обрабатывает все действия и генерирует новые улики и информацию

### 6. Обсуждение и голосование
- Игроки обсуждают полученную информацию
- Проходит голосование за самого подозрительного персонажа
- Персонаж с большинством голосов раскрывает свой секрет

### 7. Продолжение или завершение игры
- Цикл "расследование-обсуждение" повторяется, пока убийца не будет раскрыт или не совершит побег
- В конце ИИ объявляет победителей и раскрывает все детали преступления

## Особенности игры

- Динамическая генерация уникальных сценариев и персонажей
- Индивидуальные подсказки и воспоминания для каждого игрока
- ИИ-ведущий адаптирует игру на основе действий игроков
- Сочетание ролевой игры и детективного расследования
- Возможность играть как вживую, так и асинхронно (по переписке)

## Как начать играть

1. Запустите игру и выберите "Создать игру" или введите код существующей игры
2. Следуйте инструкциям ИИ-ведущего
3. Погрузитесь в роль своего персонажа и попытайтесь раскрыть преступление (или скрыть свою вину, если вы убийца)

## Структура проекта

- `cached` - Уже сгенерированные элементы сценария, чтобы не вызывать ИИ повторно
- `entites` - Основные классы бизнес логики
- `rooms` - Здесь хранятся состояние конкретной игры (для MVP выбрал хранение в файле, чтобы не тратить время на разработку БД)
- `console_api.py/telegram_api.py` - Текстовый API на основе команд, который вызывает `game_handler.py`
- `game_hadler.py` - Набор обработчиков, которые реализуют проведение игры
- `task_executor.py` - Джоба, цель которой асинхронно запускать запросы в LLM, чтобы игроки не ощущали что сценарий генерируется на лету